<% model_name = 'project' %> 

<%= autocomplete_field_tag model_name, '', eval("autocomplete_#{model_name}_title_#{model_name}_path"), :class => 'text span-7 xhr', 'data-id-element' => "##{model_name}_id", 'data-association' => model_name, 'data-controller' => model_name.pluralize %>
<%= hidden_field(model_name.to_sym, :id) %>
<hr class="space" />
<ul id="similar-projects" class="association_list">
<% current_object.similar_projects.each do |project| %>
	<%= render :partial => 'admin/projects/associated_project', :object => project, :locals => { :delete_url => remove_similar_project_project_path(current_project, :project_id => project.id) } %>
<% end %>
</ul>

<script>
$(document).ready(function(){
	$('input#<%= model_name %>').bind('railsAutocomplete.select', function(e){
		var id = $('input#<%= model_name %>_id').val(); 
		var post_data = { project_id: id };
		$(this).val('');
		$.post('<%= add_similar_project_project_path(current_object) %>', post_data, function(data) {
			$('#similar-projects').append(data);
		}, 'html');
	}); 
});
</script>
